
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://sitename.example/knime_etl/">
      
      
      
        <link rel="next" href="../power_bi_python/">
      
      
      <link rel="icon" href="../images/fish.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Importing Tilray's data into a database - max ho portfolio</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#importing-tilrays-data-into-a-database" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="max ho portfolio" class="md-header__button md-logo" aria-label="max ho portfolio" data-md-component="logo">
      
  <img src="../images/fish.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            max ho portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Importing Tilray's data into a database
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="max ho portfolio" class="md-nav__button md-logo" aria-label="max ho portfolio" data-md-component="logo">
      
  <img src="../images/fish.svg" alt="logo">

    </a>
    max ho portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Importing Tilray's data into a database
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Importing Tilray's data into a database
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knime" class="md-nav__link">
    <span class="md-ellipsis">
      KNIME
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    <span class="md-ellipsis">
      Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudocode-of-the-etl-program-similar-to-python" class="md-nav__link">
    <span class="md-ellipsis">
      Pseudocode of the ETL program (similar to Python)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-execution-of-the-etl-program" class="md-nav__link">
    <span class="md-ellipsis">
      Example execution of the ETL program
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../power_bi_python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Automating Tilray's administrative tasks using Python
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../classification_mushroom_edibility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Predicting mushroom edibility using classification models
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knime" class="md-nav__link">
    <span class="md-ellipsis">
      KNIME
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#definitions" class="md-nav__link">
    <span class="md-ellipsis">
      Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudocode-of-the-etl-program-similar-to-python" class="md-nav__link">
    <span class="md-ellipsis">
      Pseudocode of the ETL program (similar to Python)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-execution-of-the-etl-program" class="md-nav__link">
    <span class="md-ellipsis">
      Example execution of the ETL program
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="importing-tilrays-data-into-a-database">Importing Tilray's data into a database</h1>
<h2 id="summary">Summary</h2>
<p><img alt="" src="../images/knime_etl/project_diagram.png" width="1000" /></p>
<div class="admonition abstract">
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M256 0c14.7 0 28.2 8.1 35.2 21l216 400c6.7 12.4 6.4 27.4-.8 39.5S486.1 480 472 480H40c-14.1 0-27.2-7.4-34.4-19.5s-7.5-27.1-.8-39.5l216-400c7-12.9 20.5-21 35.2-21m0 352a32 32 0 1 0 0 64 32 32 0 1 0 0-64m0-192c-18.2 0-32.7 15.5-31.4 33.7l7.4 104c.9 12.5 11.4 22.3 23.9 22.3 12.6 0 23-9.7 23.9-22.3l7.4-104c1.3-18.2-13.1-33.7-31.4-33.7z"/></svg></span> <strong>Problem:</strong> Every week, the analytics team received new financial and inventory data stored in Excel files. Over time, the analytics team collected thousands of Excel files. To facilitate data analysis, my manager asked me to import the data from the Excel files into the company's database.  </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M1 11h3v2H1zm18.1-7.5L17 5.6 18.4 7l2.1-2.1zM11 1h2v3h-2zM4.9 3.5 3.5 4.9 5.6 7 7 5.6zM10 22c0 .6.4 1 1 1h2c.6 0 1-.4 1-1v-1h-4zm2-16c-3.3 0-6 2.7-6 6 0 2.2 1.2 4.2 3 5.2V19c0 .6.4 1 1 1h4c.6 0 1-.4 1-1v-1.8c1.8-1 3-3 3-5.2 0-3.3-2.7-6-6-6m1 9.9V17h-2v-1.1c-1.7-.4-3-2-3-3.9 0-2.2 1.8-4 4-4s4 1.8 4 4c0 1.9-1.3 3.4-3 3.9m7-4.9h3v2h-3z"/></svg></span> <strong>Solution:</strong> I used KNIME to develop an Extract, Transform, Load (ETL) program to extract the data from the Excel files, transform the data, then load the transformed data into SQL Server. Since many Excel files contained errors, I also implemented data quality tests to identify invalid data. </p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1.5 1.75V13.5h13.75a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1-.75-.75V1.75a.75.75 0 0 1 1.5 0m14.28 2.53-5.25 5.25a.75.75 0 0 1-1.06 0L7 7.06 4.28 9.78a.75.75 0 0 1-1.042-.018.75.75 0 0 1-.018-1.042l3.25-3.25a.75.75 0 0 1 1.06 0L10 7.94l4.72-4.72a.75.75 0 0 1 1.042.018.75.75 0 0 1 .018 1.042"/></svg></span> <strong>Results:</strong> The analytics team can now access all of the company's financial and inventory data using the company's database, instead of searching through thousands of Excel files.</p>
</div>
<h2 id="knime">KNIME</h2>
<p>KNIME is a low-code data processing application where you can chain “nodes” to create programs. A node is like a function in a programming language. </p>
<figure>
<p><img alt="" src="../images/knime_etl/knime_screenshot.png" width="600" /></p>
<figcaption>
<p>Screenshot of KNIME.</p>
</figcaption>
</figure>
<h2 id="definitions">Definitions</h2>
<p><img alt="" src="../images/knime_etl/definitions.png" width="1000" /></p>
<dl>
<dt><code>f</code></dt>
<dd>An Excel file containing sales and inventory data for one week. </dd>
<dt><code>f.data</code></dt>
<dd>The data table extracted from <code>f</code>. All columns in <code>f.data</code> are the string data type. </dd>
<dt><code>T</code></dt>
<dd>
<p>A sequence of data transformations. These include:  </p>
<ul>
<li>Transforming column contents using regular expressions.  </li>
<li>Converting column data types.  </li>
</ul>
</dd>
<dt><code>T(f.data)</code></dt>
<dd>The resulting table after applying <code>T</code> to <code>f.data</code>. </dd>
<dt><code>all_data</code></dt>
<dd>A database table that will store <code>T(f.data)</code> for every Excel file <code>f</code>.</dd>
<dt><strong>match</strong></dt>
<dd>A table <code>A</code> matches a table <code>B</code> if <code>A</code> and <code>B</code> have the same column names and data types.
<code>T(f.data)</code> can only be loaded into <code>all_data</code> if <code>T(f.data)</code> matches <code>all_data</code>.</dd>
<dt><code>all_file_names</code></dt>
<dd>A set of all the Excel file names.</dd>
<dt><code>loaded_file_names</code></dt>
<dd>A set of the Excel file names <code>f.name</code> such that <code>T(f.data)</code> has been loaded into <code>all_data</code>. </dd>
</dl>
<h2 id="pseudocode-of-the-etl-program-similar-to-python">Pseudocode of the ETL program (similar to Python)</h2>
<style>
.code {
    background-color: #f5f5f5; 
}
</style>

<pre>
<b>Algorithm</b> ETL_program(<span class="code">file_names</span>):  
    <b>Input:</b>   
        <span class="code">file_names</span>: A set of Excel file names.
    <b>Output:</b> A dictionary of (file name, error message) items. 

    <span class="code">not_loaded_file_names</span> = <span class="code">file_names</span> − <span class="code">loaded_file_names</span>. 
    <span class="code">file_name_to_error_message</span> = <span class="code">dict()</span>.

    <b>for</b> each Excel file name <span class="code">f.name</span> in <span class="code">not_loaded_file_names</span>:
        <span class="code">f.data</span> = Extract the data table from <span class="code">f</span>.  
        <b>try:</b>
            <span class="code">T(f.data)</span> = Apply each transformation in <span class="code">T</span> to <span class="code">f.data</span>. 
            Load <span class="code">T(f.data)</span> into <span class="code">all_data</span>.
        <b>except</b> Exception as <span class="code">error</span>:
            <span class="code">file_name_to_error_message[f.name]</span> = <span class="code">str(error)</span>.   
        <b>else:</b> 
            Add <span class="code">f.name</span> to <span class="code">loaded_file_names</span>.

    <b>return</b> <span class="code">file_name_to_error_message</span>.

</pre>
<p><br>
After executing <code>file_name_to_error_message = ETL_program(all_file_names)</code>, I execute the following steps manually:</p>
<pre>
<b>for</b> <span class="code">f.name</span>, <span class="code">error_message</span> in <span class="code">file_name_to_error_message.items()</span>:
    Use <span class="code">error_message</span> to update the data transformations in <span class="code">T</span>. 
    Execute <span class="code">ETL_program(set(f.name))</span>. 
</pre>

<h2 id="example-execution-of-the-etl-program">Example execution of the ETL program</h2>
<dl>
<dt><code>T</code>:</dt>
<dd>
<ol>
<li>Convert <code>date</code> to the date data type.    </li>
<li>Convert <code>column_a</code> to the integer data type.   </li>
</ol>
</dd>
</dl>
<p><strong>1. Execute <code>ETL_program(set(f_1.name))</code>:</strong>  </p>
<figure>
<p><img alt="" src="../images/knime_etl/etl_program_1.png" width="800" /></p>
<figcaption>
<p><code>T(f_1.data)</code> can't be loaded into <code>all_data</code> because <code>"missing"</code> in <code>column_a</code> can't be converted to an integer. </p>
</figcaption>
</figure>
<p><strong>2. Update <code>T</code>:</strong>  </p>
<dl>
<dt><code>T</code>:</dt>
<dd>
<ol>
<li>Convert <code>date</code> to the date data type.    </li>
<li><span style="background-color:#d8f5e6">In <code>column_a</code>, replace all cells matching the regular expression <code>“^missing$”</code> with <code>null</code>.</span></li>
<li>Convert <code>column_a</code> to the integer data type.</li>
</ol>
</dd>
</dl>
<p><strong>3. Execute <code>ETL_program(set(f_1.name))</code>:</strong>    </p>
<figure>
<p><img alt="" src="../images/knime_etl/etl_program_2.png" width="1000" /></p>
<figcaption>
<p>After updating <code>T</code>, <code>T(f_1.data)</code> is loaded into <code>all_data</code>.</p>
</figcaption>
</figure>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../javascripts/katex.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
      
        <script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>